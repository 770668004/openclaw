# File Maintenance Skill

## 功能概述
这是一个自动化文件审查和维护技能，能够：
- **安全审查**：检测文件中的错误、逻辑问题、恶意或危险内容
- **重复清理**：识别并整合重复、冗余的文件
- **内容优化**：对现有内容进行整理和进化升级
- **弹性执行**：每24小时自动运行，但优先级低于用户当前任务

## 使用方法

### 手动触发
```bash
# 在OpenClaw中使用技能
/file-maintenance run

# 或者直接调用脚本
cd ~/.openclaw/workspace/skills/file-maintenance/scripts
./scan_and_clean.sh
```

### 自动调度
技能支持通过OpenClaw的cron系统进行自动调度。建议配置为每24小时执行一次：

```bash
# 添加到OpenClaw cron（示例）
0 */24 * * * /file-maintenance --auto
```

## 安全特性

### 保护机制
- **只读扫描**：默认情况下只进行分析，不自动删除文件
- **日志记录**：所有操作都会详细记录到 `memory/file-maintenance-YYYY-MM-DD.log`
- **用户确认**：对于高风险操作（如删除文件），需要用户明确确认
- **备份优先**：在进行任何修改前，会自动创建备份

### 危险内容检测
脚本会检测以下类型的危险内容：
- 破坏性命令（如 `rm -rf`、`dd` 等）
- 无限递归函数（fork bomb）
- 文件系统格式化命令
- 其他明显的恶意模式

## 配置选项

### 扫描范围
- 默认扫描整个工作区目录 (`~/.openclaw/workspace`)
- 特别关注 `memory/` 和 `skills/` 目录
- 跳过二进制文件，只处理文本文件

### 执行策略
- **弹性执行**：如果检测到用户正在进行其他重要任务，会推迟执行
- **低优先级**：始终以用户当前任务为优先
- **可中断**：用户可以随时停止执行

## 输出说明

### 日志格式
日志文件包含以下信息：
- 扫描开始和结束时间
- 发现的问题文件列表
- 检测到的重复文件
- 建议的操作步骤

### 报告内容
每次执行后会生成详细的报告，包括：
- 文件完整性检查结果
- 安全风险评估
- 重复文件统计
- 优化建议

## 注意事项

1. **权限要求**：脚本需要对工作区目录有读取权限
2. **存储空间**：日志文件会占用少量存储空间，建议定期清理
3. **自定义规则**：可以通过修改脚本来添加自定义的危险模式检测
4. **手动审核**：自动检测结果建议进行人工审核后再执行删除操作

## 维护和更新

- 定期更新危险模式检测规则
- 根据实际使用情况调整扫描策略
- 添加新的文件类型支持