# File Maintenance Skill - 使用指南

## 基本命令

### 手动执行完整扫描
```
/file-maintenance scan
```
执行完整的文件审查、安全检查和重复文件检测。

### 仅安全审查
```
/file-maintenance security-check
```
只进行安全内容审查，不处理重复文件。

### 仅重复文件检测
```
/file-maintenance find-duplicates
```
只查找和报告重复文件。

### 自动模式（用于定时任务）
```
/file-maintenance --auto
```
以低优先级自动运行，适合在后台定时执行。

## 高级选项

### 指定扫描目录
```
/file-maintenance scan --dir /path/to/directory
```

### 设置日志级别
```
/file-maintenance scan --verbose
```

### 干运行模式（不实际修改）
```
/file-maintenance scan --dry-run
```

## 定时任务配置

要设置每24小时自动执行，可以使用OpenClaw的cron功能：

1. **添加定时任务**：
   ```
   /cron add "0 */24 * * *" "/file-maintenance --auto"
   ```

2. **查看当前定时任务**：
   ```
   /cron list
   ```

3. **删除定时任务**：
   ```
   /cron remove <task_id>
   ```

## 安全确认流程

当检测到需要删除或修改文件时，系统会：

1. **生成详细报告**：列出所有建议操作
2. **请求用户确认**：显示具体要执行的操作
3. **执行前备份**：自动创建备份副本
4. **记录操作日志**：详细记录所有变更

## 弹性执行机制

- **任务优先级**：此技能始终以最低优先级运行
- **自动推迟**：如果检测到用户正在进行其他任务，会自动推迟执行
- **可中断**：用户可以随时通过 `/stop` 命令停止执行
- **资源限制**：限制CPU和内存使用，避免影响系统性能

## 故障排除

### 常见问题
- **权限错误**：确保脚本有执行权限 (`chmod +x`)
- **日志文件过大**：定期清理旧的日志文件
- **误报问题**：可以根据实际情况调整危险模式检测规则

### 调试模式
```
/file-maintenance debug
```
启用详细调试输出，帮助诊断问题。

## 自定义配置

可以通过编辑以下文件来自定义行为：
- `scripts/scan_and_clean.sh` - 主要扫描逻辑
- `config/rules.txt` - 危险模式检测规则（如果存在）

## 注意事项

⚠️ **重要提醒**：
- 此技能默认不会自动删除任何文件
- 所有高风险操作都需要用户明确确认
- 建议先在测试环境中验证效果
- 定期检查日志文件了解扫描结果